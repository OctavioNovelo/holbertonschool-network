#!/usr/bin/env bash
# Script to list listening ports with associated program names and PIDs

echo "Active Internet connections (only servers)"
echo "Proto Recv-Q Send-Q Local Address           Foreign Address         State       PID/Program name"
ss -tulnp | awk '
  BEGIN { OFS=" "; ORS="\n" }
  /LISTEN/ {
    if ($1 == "tcp" || $1 == "udp" || $1 == "tcp6" || $1 == "udp6") {
      printf "%s        %s %s %s %s %s %s\n", $1, $2, $3, $4, $5, $6, $7
    }
  }
'

echo -e "\nActive UNIX domain sockets (only servers)"
echo "Proto RefCnt Flags       Type       State         I-Node   PID/Program name    Path"
ss -xlnp | awk '
  BEGIN { OFS=" "; ORS="\n" }
  /LISTEN/ {
    printf "%s  %s      %s      %s     %s     %s     %s    %s\n", $1, $2, $3, $4, $5, $6, $7, $8
  }
'
